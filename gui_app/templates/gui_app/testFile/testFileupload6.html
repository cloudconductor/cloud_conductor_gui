{% extends "gui_app/base.html" %}
{% block title %}File Upload Test{% endblock %}
{% block headerscript %}{% endblock %}

{% block nav %}
    {% include "gui_app/includes/nav_menu.html" %}
{% endblock %}
{% block breadcrumb %}
	<li>《Sample》 Management</li>
{% endblock %}
{% block content %}
{% block bodyscripttop %}
<script>

function read (ele) {

	var isJson = function(arg){
        arg = (typeof(arg) == "function") ? arg() : arg;
        if(typeof(arg) != "string"){return false;}
        try{arg = (!JSON) ? eval("(" + arg + ")") : JSON.parse(arg);return true;}catch(e){return false;}
    }

	alert("きた１");
    if (!ele.files.length) return; // ファイル未選択

	alert("きた２");
    var file = ele.files[0];
	alert("きた２.5");
	alert("type:" + file.type);
	alert("name:" + file.name);

    if (!/^application\/json/.test(file.type)){
    // if (!/^application\//.test(file.type)){
    // if (!/^text\/javascript/.test(file.type)){
    	alert("きた３");
    	return;  // text/plain, text/html, ...
    }

    alert("きた４");
    var fr = new FileReader();
    fr.onload = function () {
        document.getElementById('text').value = fr.result;  // 読み込み結果をtextareaに
    };

    alert("きた５")
    fr.readAsText(file);  // ファイルをテキストとして読み込む
}

</script>
{% endblock %}


  <div class="cc-title">File Upload Test</div>
	<br>

	<input type="file" onchange="read(this)" accept="application/json"  />

	<hr />
	<textarea id="text" cols="80" rows="20" wrap="off"></textarea>


{% endblock %}

{% block bodyscript %}{% endblock %}